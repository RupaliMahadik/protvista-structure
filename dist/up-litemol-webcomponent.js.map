{"version":3,"file":"up-litemol-webcomponent.js","sources":["../src/main.js"],"sourcesContent":["const loadComponent = function () {\n    class UpLitemolWebcomponent extends HTMLElement {\n\n        constructor() {\n            super();\n            // We can't use the shadow DOM as the LiteMol component interacts with the\n            // document DOM.\n            this.loadMolecule = this\n                .loadMolecule\n                .bind(this);\n            this.loadStructureTable = this\n                .loadStructureTable\n                .bind(this);\n            this.innerHTML = `\n                <style>\n                    .jsmol-container, .table-container {\n                        width: 640px; \n                        height: 480px; \n                        position: relative;\n                        display:inline-block;\n                    }\n                </style>\n            `;\n        }\n\n        getAccession() {\n            return this.getAttribute('accession');\n        }\n\n        setAccession(accession) {\n            return this.setAttribute('accession', accession);\n        }\n\n        connectedCallback() {\n            this.tableDiv = document.createElement('div');\n            this.tableDiv.className = 'table-container';\n            const jsmolDiv = document.createElement('div');\n            jsmolDiv.className = 'jsmol-container';\n            jsmolDiv.id = 'app';\n            this.appendChild(jsmolDiv);\n            this.appendChild(this.tableDiv);\n            this.loadLiteMol();\n            this\n                .loadEntry()\n                .then(entry => {\n                    const pdbEntries = entry\n                        .dbReferences\n                        .filter(dbref => dbref.type === 'PDB');\n                    this.loadStructureTable(pdbEntries);\n                    this.loadMolecule(pdbEntries[0].id);\n                });\n            // this.loadMolecule(this.id);\n        }\n\n        attributeChangedCallback(attrName, oldVal, newVal) {}\n\n        async loadEntry() {\n            try {\n                return await(await fetch(`https://www.ebi.ac.uk/proteins/api/proteins/${this.getAccession()}`)).json();\n            } catch (e) {\n                console.log(`Couldn't load UniProt entry`, e);\n            }\n        }\n\n        loadStructureTable(pdbEntries) {\n            const html = `\n                <table>\n                    <thead><th>PDB Entry</th><th>Method</th><th>Resolution</th><th>Chain</th></thead>\n                    <tbody>\n                        ${pdbEntries\n                .map(d => `\n                            <tr id=\"${d.id}\" class=\"pdb-row\">\n                                <td>${d.id}</td>\n                                <td>${d.properties.method}</td>\n                                <td>${d.properties.resolution}</td>\n                                <td>${d.properties.chains}</td>\n                            </tr>\n                        `)\n                .join('')}\n                    </tbody>\n                </table>\n            `;\n            this.tableDiv.innerHTML = html;\n            this\n                .querySelectorAll('.pdb-row')\n                .forEach(row => row.addEventListener('click', () => this.loadMolecule(row.id)));\n        }\n\n        loadLiteMol() {\n            const Plugin = LiteMol.Plugin;\n            this._liteMol = Plugin.create({\n                target: '#app',\n                viewportBackground: '#fff',\n                layoutState: {\n                    hideControls: true\n                },\n                allowAnalytics: false\n            });\n        }\n\n        loadMolecule(_id) {\n            this\n                ._liteMol\n                .loadMolecule({\n                    _id, format: 'cif', // or pdb, sdf, binarycif/bcif\n                    url: `https://www.ebi.ac.uk/pdbe/static/entry/${_id.toLowerCase()}_updated.cif`,\n                    // instead of url, it is possible to use data: \"string\" or ArrayBuffer (for\n                    // BinaryCIF) loaded molecule and model can be accessed after load using\n                    // plugin.context.select(modelRef/moleculeRef)[0], for example\n                    // plugin.context.select('1tqn-molecule')[0]\n                    moleculeRef: _id + '-molecule',\n                    modelRef: _id + '-model',\n                    // Use this if you want to create your own visual. doNotCreateVisual: true\n                })\n                .then(() => {\n                    // Use this (or a modification of this) for custom visualization: const style =\n                    // LiteMol.Bootstrap.Visualization.Molecule.Default.ForType.get('BallsAndSticks'\n                    // ); const t = plugin.createTransform(); t.add(id + '-model',\n                    // LiteMol.Bootstrap.Entity.Transformer.Molecule.CreateVisual, { style: style })\n                    // plugin.applyTransform(t);\n                    console.log('Molecule loaded');\n                })\n                .catch(e => {\n                    console.error(e);\n                });\n        }\n\n    }\n    customElements.define('up-litemol-webcomponent', UpLitemolWebcomponent);\n}\n\n// Conditional loading of polyfill\nif (window.customElements) {\n    loadComponent();\n} else {\n    document\n        .addEventListener('WebComponentsReady', function () {\n            loadComponent();\n        });\n}"],"names":["loadComponent","UpLitemolWebcomponent","loadMolecule","bind","loadStructureTable","innerHTML","getAttribute","accession","setAttribute","tableDiv","document","createElement","className","jsmolDiv","id","appendChild","loadLiteMol","loadEntry","then","pdbEntries","entry","dbReferences","filter","dbref","type","attrName","oldVal","newVal","fetch","getAccession","json","log","html","map","d","properties","method","resolution","chains","join","querySelectorAll","forEach","row","addEventListener","Plugin","LiteMol","_liteMol","create","_id","format","toLowerCase","catch","error","e","HTMLElement","define","window","customElements"],"mappings":"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"}