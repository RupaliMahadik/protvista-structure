(function(){"use strict";var a=function(){function a(a){this.value=a}function b(b){function c(e,f){try{var g=b[e](f),h=g.value;h instanceof a?Promise.resolve(h.value).then(function(a){c("next",a)},function(a){c("throw",a)}):d(g.done?"return":"normal",g.value)}catch(a){d("throw",a)}}function d(a,b){"return"===a?e.resolve({value:b,done:!0}):"throw"===a?e.reject(b):e.resolve({value:b,done:!1});e=e.next,e?c(e.key,e.arg):f=null}var e,f;this._invoke=function(a,b){return new Promise(function(d,g){var h={key:a,arg:b,resolve:d,reject:g,next:null};f?f=f.next=h:(e=f=h,c(a,b))})},"function"!=typeof b.return&&(this.return=void 0)}return"function"==typeof Symbol&&Symbol.asyncIterator&&(b.prototype[Symbol.asyncIterator]=function(){return this}),b.prototype.next=function(a){return this._invoke("next",a)},b.prototype.throw=function(a){return this._invoke("throw",a)},b.prototype.return=function(a){return this._invoke("return",a)},{wrap:function(a){return function(){return new b(a.apply(this,arguments))}},await:function(b){return new a(b)}}}(),b=function(a){return function(){var b=a.apply(this,arguments);return new Promise(function(a,c){function d(e,f){try{var g=b[e](f),h=g.value}catch(a){return void c(a)}return g.done?void a(h):Promise.resolve(h).then(function(a){d("next",a)},function(a){d("throw",a)})}return d("next")})}},c=function(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")},d=function(){function a(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),e=function(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)},f=function(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return b&&("object"==typeof b||"function"==typeof b)?b:a},g=function(){var a=function(a){function g(){c(this,g);// We can't use the shadow DOM as the LiteMol component interacts with the
// document DOM.
var a=f(this,(g.__proto__||Object.getPrototypeOf(g)).call(this));a.loadMolecule=a.loadMolecule.bind(a),a.loadStructureTable=a.loadStructureTable.bind(a);var b=document.createElement("style");return a.appendChild(b),b.innerHTML="\n                :root {\n                    --blue: 0,112,155;\n                    --width: 100%;\n                }\n                up-litemol-webcomponent {\n                    display:flex;\n                }\n                .jsmol-container, .table-container {\n                    width: var(--width);\n                    height: 480px;\n                    position: relative;\n                }\n                .table-container table {\n                    width:100%;\n                    height: 480px;\n                    border-collapse: collapse;\n                }\n                .table-container thead {\n                    min-height: 3em;\n                  }\n                  \n                .table-container th, .table-container td {\n                    box-sizing: border-box;\n                    flex: 1 0 10em;\n                    overflow: hidden;\n                    text-overflow: ellipsis;\n                }\n                .table-container table, .table-container thead, .table-container tbody, .table-container tfoot {\n                    display: flex;\n                    flex-direction: column;\n                }\n                .table-container tr {\n                    display: flex;\n                    flex: 1 0;\n                }\n                .table-container tbody {\n                    overflow-y: auto;\n                }\n                .table-container tbody tr {\n                    cursor: pointer;\n                }\n                .table-container tbody tr:hover {\n                    background-color: rgba(var(--blue), 0.15);;\n                }\n                .table-container tr.active {\n                    background-color: rgba(var(--blue), 0.3);;\n                }\n            ",a}return e(g,a),d(g,[{key:"getAccession",value:function(){return this.getAttribute("accession")}},{key:"setAccession",value:function(a){return this.setAttribute("accession",a)}},{key:"connectedCallback",value:function(){var a=this;this.tableDiv=document.createElement("div"),this.tableDiv.className="table-container";var b=document.createElement("div");b.className="jsmol-container",b.id="app",this.appendChild(b),this.appendChild(this.tableDiv),this.loadLiteMol(),this.loadEntry().then(function(b){var c=b.dbReferences.filter(function(a){return"PDB"===a.type});a.loadStructureTable(c),a.selectMolecule(c[0].id)})}},{key:"attributeChangedCallback",value:function(){}},{key:"loadEntry",value:function(){var a=b(/*#__PURE__*/regeneratorRuntime.mark(function a(){return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,fetch("https://www.ebi.ac.uk/proteins/api/proteins/"+this.getAccession());case 3:return a.next=5,a.sent.json();case 5:return a.abrupt("return",a.sent);case 8:a.prev=8,a.t0=a["catch"](0),console.log("Couldn't load UniProt entry",a.t0);case 11:case"end":return a.stop();}},a,this,[[0,8]])}));return function(){return a.apply(this,arguments)}}()},{key:"loadStructureTable",value:function(a){var b=this,c="\n                <table>\n                    <colgroup>\n                        <col syle=\"width: 100px\">\n                        <col syle=\"width: 100px\">\n                        <col syle=\"width: 100px\">\n                        <col syle=\"width: auto\">\n                    </colgroup>\n                    <thead><th>PDB Entry</th><th>Method</th><th>Resolution</th><th>Chain</th></thead>\n                    <tbody>\n                        "+a.map(function(a){return"\n                            <tr id=\""+a.id+"\" class=\"pdb-row\">\n                                <td>"+a.id+"</td>\n                                <td>"+a.properties.method+"</td>\n                                <td>"+a.properties.resolution+"</td>\n                                <td>"+a.properties.chains+"</td>\n                            </tr>\n                        "}).join("")+"\n                    </tbody>\n                </table>\n            ";this.tableDiv.innerHTML=c,this.querySelectorAll(".pdb-row").forEach(function(a){return a.addEventListener("click",function(){return b.selectMolecule(a.id)})})}},{key:"selectMolecule",value:function(a){this.querySelectorAll(".active").forEach(function(a){return a.classList.remove("active")}),document.getElementById(a).classList.add("active"),this.loadMolecule(a)}},{key:"loadLiteMol",value:function(){var a=LiteMol.Plugin;this._liteMol=a.create({target:"#app",viewportBackground:"#fff",layoutState:{hideControls:!0},allowAnalytics:!1})}},{key:"loadMolecule",value:function(a){this._liteMol.clear(),this._liteMol.loadMolecule({_id:a,format:"cif",// or pdb, sdf, binarycif/bcif
url:"https://www.ebi.ac.uk/pdbe/static/entry/"+a.toLowerCase()+"_updated.cif",// instead of url, it is possible to use data: "string" or ArrayBuffer (for
// BinaryCIF) loaded molecule and model can be accessed after load using
// plugin.context.select(modelRef/moleculeRef)[0], for example
// plugin.context.select('1tqn-molecule')[0]
moleculeRef:a+"-molecule",modelRef:a+"-model"// Use this if you want to create your own visual. doNotCreateVisual: true
}).then(function(){console.log("Molecule loaded")}).catch(function(a){console.error(a)})}}]),g}(HTMLElement);customElements.define("up-litemol-webcomponent",a)};// Conditional loading of polyfill
window.customElements?g():document.addEventListener("WebComponentsReady",function(){g()})})();
//# sourceMappingURL=up-litemol-webcomponent.js.map
